extends ../layout

block content
  .container-fluid
    .row
      .col-md-12
        .card
          .card-header
            h4.text-center.text-primary Confirmar turno en #{clinica.nombre}
            if procedimiento
              h5.text-center.text-danger Procedimiento: #{procedimiento.nombre}
          
          .card-body
            form(method="post" action="reservar")
              .form-group
                input#id(type="hidden" name="id" class="form-control" value=turno.id)
                
              .form-group.mb-3
                label(for="persona") Persona que solicita turno:
                select#persona(name="persona" class="form-control" required)
                  option(value="NULL" disabled selected) Seleccione persona
                  each paciente in pacientes
                    option(value=paciente.id) #{paciente.nombre} #{paciente.apellido}
              
              .info-turno.mb-4
                h6.text-center.mt-3 Secretario: #{persona.nombre} #{persona.apellido}
                h6.text-center.mt-3 Clinica: #{clinica.nombre}
                h6.text-center.mt-3 Direccion: #{clinica.direccion}
                - const fecha = calendario && calendario.fecha ? calendario.fecha : turno.fechaturno
                h6.text-center.mt-3(data-order=moment(fecha).format('YY/MM/DD'))
                  | Fecha: #{moment(fecha).format('DD/MM/YYYY')}
                h6.text-center.mt-3 Hora: #{turno.hora_turno}
                
              .form-group.mb-3
                label(for="comentario") Comentario:
                textarea#comentario.form-control(name="comentario" rows="3")
                
              .d-flex.justify-content-center.gap-3.mt-4
                if turno.estadoturno_id === 4
                  .alert.alert-success.text-center Turno Confirmado
                else
                  button.btn.btn-primary.confirmar-turno(data-turno-id=turno.turniid) Confirmar Turno
                  button.btn.btn-danger.cancelar-turno(data-turno-id=turno.turniid) Cancelar Turno

              .d-flex.justify-content-center.mt-3
                a.btn.btn-secondary.me-2(href='/turno/buscarAgenda') Cancelar

block scripts
  script(src="//cdn.jsdelivr.net/npm/sweetalert2@11")
  script(src="https://code.jquery.com/jquery-3.6.0.min.js")
  script.
    $(document).ready(function() {
      $('#persona').select2({
        theme: 'bootstrap4',
        placeholder: 'Buscar paciente...',
        allowClear: true
      });
    }); 