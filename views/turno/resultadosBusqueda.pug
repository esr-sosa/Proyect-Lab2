extends ../layout

block content
  .container-fluid
    .row
      .col-12
        .card
          .card-header.d-flex.justify-content-between.align-items-center
            h4.mb-0 Turnos Disponibles
            button.btn.btn-secondary(onclick='window.history.back()')
              i.fas.fa-arrow-left.me-1
              | Volver
          
          .card-body
            if Object.keys(turnosAgrupados).length === 0
              .alert.alert-info No hay turnos disponibles
            else
              #acordeonTurnos.accordion
                each turnos, fecha in turnosAgrupados
                  .accordion-item
                    h2.accordion-header
                      button.accordion-button(
                        type='button'
                        data-bs-toggle='collapse'
                        data-bs-target=`#collapse${moment(fecha).format('YYYYMMDD')}`
                      )
                        | #{moment(fecha).format('DD/MM/YYYY')}
                        span.badge.bg-primary.ms-2 #{turnos.length} turnos
                    
                    .accordion-collapse.collapse(id=`collapse${moment(fecha).format('YYYYMMDD')}`)
                      .accordion-body
                        .table-responsive
                          table.table.table-hover
                            thead
                              tr
                                th Hora
                                th Médico
                                th Especialidad
                                th Sucursal
                                th Acción
                            tbody
                              each turno in turnos
                                tr
                                  td= moment(turno.inicioturno, 'HH:mm:ss').format('HH:mm')
                                  td= `${turno.medico_nombre} ${turno.medico_apellido}`
                                  td= turno.especialidad
                                  td= turno.sucursal_nombre
                                  td
                                    if turno.estado_turno === 1
                                      button.btn.btn-primary.btn-sm(onclick=`reservarTurno(${turno.calendarid}, ${pacienteId})`)
                                        i.fas.fa-calendar-check.me-1
                                        | Confirmar Reserva

block scripts
  script(src="/js/turno/reserva.js")